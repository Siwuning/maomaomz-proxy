{
    "id": "60e5e0c5-0617-4252-8a5f-e9432bb06bd5",
    "scriptName": "script注入",
    "findRegex": "<script src=\"MultiverseTerminalSystem.js\"></script>",
    "replaceString": "<script>\nlet currentPage = 0;\nconst pages = document.querySelectorAll('.page');\nconst navTabs = document.querySelectorAll('.sidebar .nav-tab');\n\nfunction turnToPage(pageIndex) {\n    // 移除翻页效果并重置页面\n    pages.forEach(page => {\n        page.classList.remove('flipped');\n        page.style.zIndex = 'auto';\n    });\n\n    // 根据目标页面索引应用翻页效果\n    if (pageIndex === 0) {\n        // 如果目标是封面，则所有页面都翻回正面\n        pages.forEach((page, index) => {\n            page.style.zIndex = pages.length - index;\n            if (index > 0) {\n                page.classList.add('flipped');\n            }\n        });\n    } else {\n        // 对封面之外的页面，翻到对应页\n        for (let i = 0; i < pages.length; i++) {\n            if (i < pageIndex) {\n                pages[i].style.zIndex = pages.length - i;\n                pages[i].classList.add('flipped');\n            } else {\n                pages[i].style.zIndex = pages.length - i;\n            }\n        }\n    }\n\n    currentPage = pageIndex;\n    updateNavTabs();\n}\n\nfunction updateNavTabs() {\n    navTabs.forEach(tab => {\n        const tabPageIndex = parseInt(tab.dataset.page);\n        if (tabPageIndex === currentPage) {\n            tab.classList.add('active');\n        } else {\n            tab.classList.remove('active');\n        }\n    });\n}\n\n// 初始化\nturnToPage(0);\n\n// 侧边导航栏\nnavTabs.forEach(tab => {\n    tab.addEventListener('click', () => {\n        const pageIndex = parseInt(tab.dataset.page);\n        turnToPage(pageIndex);\n    });\n});\n\n// 头像框点击事件\nconst avatarContainer = document.querySelector('.avatar-container');\navatarContainer.addEventListener('click', () => {\n    avatarContainer.classList.add('clicked');\n    setTimeout(() => {\n        avatarContainer.classList.remove('clicked');\n        turnToPage(1); // 翻到第二页\n    }, 300);\n});\n\ndocument.addEventListener('DOMContentLoaded', function () {\n    updateProgressBars();\n    // 为标题添加随机旋转和马克笔效果\n    const markerTitles = document.querySelectorAll('.marker-title');\n    markerTitles.forEach(title => {\n        const rotation = Math.random() * 0 - 2; //旋转度数\n        title.style.display = 'inline-block'; // 使旋转生效\n        title.style.transform = `rotate(${rotation}deg)`;\n    });\n});\n\n// 响应式缩放函数\nfunction adjustScale() {\n    const screenWidth = window.innerWidth;\n    const standardWidth = parseFloat(getComputedStyle(document.documentElement).getPropertyValue('--width-standard'));\n\n    if (screenWidth < standardWidth) {\n        const scale = screenWidth / standardWidth;\n        document.documentElement.style.setProperty('--scale', scale);\n    } else {\n        document.documentElement.style.setProperty('--scale', 0.9);\n    }\n}\n\n// 初始化时调用一次\nadjustScale();\n\n// 监听 resize 事件\nwindow.addEventListener('resize', adjustScale);\n\nfunction updateProgressBars() {\n    const progressBars = document.querySelectorAll('.progress-bar');\n    progressBars.forEach(bar => {\n        let value = bar.dataset.value;\n        // 提取百分比数字\n        let percentage = parseInt(value.replace(/[^0-9]/g, '')); // 移除非数字字符并转换为整数\n        const fill = bar.querySelector('.progress-fill');\n        fill.style.width = `${percentage}%`;\n    });\n}\n\n// 点击翻页逻辑 (已修正)\npages.forEach((page, index) => {\n    page.addEventListener('click', () => {\n        // 始终添加监听器，但在函数内部判断是否处于响应式模式\n        if (window.innerWidth <= 800) {\n            if (index === 3) {\n                turnToPage(0); // 点击商城页面返回封面\n            } else if (index < 3){\n                turnToPage(currentPage + 1); // 点击其他内页翻到下一页\n            }\n        }\n    });\n});\n\n\n\n\ndocument.addEventListener('DOMContentLoaded', function() {\n    // 检查是否处于移动设备视图\n    function isMobileView() {\n        return window.innerWidth <= 800;\n    }\n\n    // 调整地址栏样式\n    function adjustLocationStyle() {\n        const locationElement = document.querySelector('.location');\n        if (locationElement) {\n            if (isMobileView()) {\n                locationElement.style.position = 'relative';\n                locationElement.style.top = 'auto';\n                locationElement.style.right = 'auto';\n                locationElement.style.left = '50%';\n                locationElement.style.marginLeft = '-40%';\n                locationElement.style.width = '80%';\n                locationElement.style.textAlign = 'center';\n                locationElement.style.direction = 'ltr';\n            } else {\n                // 恢复默认样式\n                locationElement.style.position = 'relative';\n                locationElement.style.top = '120px';\n                locationElement.style.right = '-220px';\n                locationElement.style.left = 'auto';\n                locationElement.style.marginLeft = '0';\n                locationElement.style.width = '300px';\n                locationElement.style.textAlign = 'right';\n                locationElement.style.direction = 'rtl';\n            }\n        }\n    }\n\n    // 初始调整\n    adjustLocationStyle();\n\n    // 监听窗口大小变化\n    window.addEventListener('resize', adjustLocationStyle);\n});\n\n\n\n</script>",
    "trimStrings": [],
    "placement": [
        2
    ],
    "disabled": false,
    "markdownOnly": true,
    "promptOnly": false,
    "runOnEdit": true,
    "substituteRegex": 2,
    "minDepth": null,
    "maxDepth": null
}